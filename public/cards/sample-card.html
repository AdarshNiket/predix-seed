<link rel="import" href="../bower_components/polymer/polymer.html"/>
<link rel="import" href="../bower_components/px-card/px-card.html"/>
<link rel="import" href="../bower_components/px-card/px-card-behavior.html"/>

<dom-module id="px-widget">
    <template>
        <div>Dummy Timeseries</div>
        <div>Min: <span>{{chartState.min}}</span></div>
        <div>Max: <span>{{chartState.max}}</span></div>
        <button on-click="zoom">Zoom</button>
    </template>

</dom-module>
<script>
    Polymer({
        is: 'px-widget',
        properties: {
            chartState: {
                type: Object,
                notify: true
            },
            gauge: {
                type: Object
            }
        },
        zoom: function() {
            console.log('fake time series chart zoomed');
            this.chartState.min++;
            this.chartState.max--;

//            // optionally set changes individually to reflect in DOM and rollup
//            this.set('chartState.min', this.chartState.min);
//            this.set('chartState.max', this.chartState.max);
//
//            // or, aggregate all your state changes together
//            this.updateMyState();

            this.updateMyState();
        },
        ready: function() {
            this.chartState = {
                min: 0,
                max: 100
            }
        },
        updateMyState: function() {
            this.set('chartState', {
                min: this.chartState.min,
                max: this.chartState.max
            });
        }
    });
</script>


<dom-module id="sample-card">
    <template>
        <px-card>
            <div style="border:black 2px solid;">
                <px-widget chart-state="{{chartState}}"></px-widget>
            </div>
        </px-card>
    </template>
</dom-module>
<script>

    Polymer({
        is: 'sample-card',
        observers: ['chartStateChanged(chartState.*)'],
        dealerStateChanged: function(newState, oldState) {

            this.chartState = {
                min: newState.zoom.min,
                max: newState.zoom.max
            };

        },
        chartStateChanged: function(newChartState) {
            console.log(this.id + ' new chart state in sample card', newChartState);
            this.updateDeck({
                zoom: {min: newChartState.base.min, max: newChartState.base.max}
            });
        },
        behaviors: [px.cardBehavior]
    });
</script>
