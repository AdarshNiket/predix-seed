<dom-module id="px-view-selector">
    <template>
        <button on-click="switchDeck">views/sample-cards.html</button>
        <button on-click="switchDeck">views/card-to-card.html</button>
        <button on-click="switchDeck">views/fetch-data.html</button>
    </template>
</dom-module>
<script>
    Polymer({
        is: 'px-view-selector',
        properties: {
            selectedView: {
                type: String,
                notify: true
            }
        },
        switchDeck: function(e) {
            var selectedView = e.target.textContent;
            this.set('selectedView', selectedView);
            console.log(selectedView);
        }
    })
</script>

<dom-module id="px-dashboard">
    <template>
        <h2>Context in the dahsboard:<span>{{context.name}}</span></h2>
        <div id="desk"></div>
    </template>
</dom-module>
<script>
    window.loaded = window.loaded || {};

    Polymer({
        is: 'px-dashboard',
        properties: {
            selectedView: {
                type: String,
                observer: "viewSelected"
            }
        },
        viewSelected: function(newView) {
            this.switchDeck(newView);
        },
        contextChanged: function(newContext) {
            console.log('NEWCONTEXT', newContext);
        },
        ready: function() {
        },
        switchDeck: function(url) {

            var container = document.getElementById('desk');

            var deckContent;
            var self = this;

//            if (loaded[url]) {
//                deckContent = loaded[url];
//                container.innerHTML = deckContent;
//            }
//            else {
                Polymer.Base.importHref(url, function(e) {
                    var container = document.getElementById('desk');
                    container.innerHTML = "";
                    e.target.import.querySelector('px-deck').context = self.context;
                    var deckContent = e.target.import.querySelector('body');//.innerHTML;
                    console.log(deckContent);
                    //deckContent = "<px-deck>" + deckContent + "</px-deck>";
                    loaded[url] = deckContent;
//                    container.innerHTML = deckContent;
                    container.appendChild(deckContent);
                }, function(e) {

                });
            }
//        }
    })

</script>

<!---------->


<template is="dom-bind">

    <px-context-selector class="clearfix" data-config="contextSelectorConfig"></px-context-selector>

    <px-view-selector selected-view="{{selectedView}}"></px-view-selector>

    <h1>This is the context name (not in the card): {{context.name}}</h1>

    <px-dashboard selected-view="{{selectedView}}" context="{{context}}">
        <!--<px-view-selector selected-view="{{selectedView}}"></px-view-selector>-->

    </px-dashboard>

    <div>SelectedView: <span>{{selectedView}}</span></div>

</template>


