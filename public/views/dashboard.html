<dom-module id="px-view-selector">
    <template>
        <button on-click="switchDeck">views/sample-cards.html</button>
        <button on-click="switchDeck">views/card-to-card.html</button>
        <button on-click="switchDeck">views/fetch-data.html</button>
    </template>
</dom-module>
<script>
    Polymer({
        is: 'px-view-selector',
        properties: {
            selectedView: {
                type: String,
                notify: true
            }
        },
        switchDeck: function(e) {
            var selectedView = e.target.textContent;
            this.set('selectedView', selectedView);
            console.log(selectedView);
        }
    })
</script>

<dom-module id="px-dashboard">
    <template>
        <div id="desk"></div>
    </template>
</dom-module>
<script>
    window.loaded = window.loaded || {};

    Polymer({
        is: 'px-dashboard',
        properties: {
            selectedView: {
                type: String,
                observer: "viewSelected"
            }
        },
        viewSelected: function(newView) {
            this.switchDeck(newView);
        },
        contextChanged: function(newContext) {
            console.log('NEWCONTEXT', newContext);
        },
        ready: function() {
        },
        switchDeck: function(url) {

            var self = this;
            var container = document.getElementById('desk');

            container.innerHTML = "";
            if (!loaded[url]) {
                Polymer.Base.importHref(url, function (e) {
                    debugger;
                    var deck = e.target.import.body;
                    container.appendChild(deck);
                    loaded[url] = deck;
                    document.querySelector('px-deck').context = self.context;
                }, function (e) {

                });
            }
            else {
                container.appendChild(loaded[url]);
                document.querySelector('px-deck').context = this.context;
            }
        }
    });

</script>

<!---------->


<template is="dom-bind">

    <px-context-selector class="clearfix" data-config="contextSelectorConfig"></px-context-selector>
    <button ng-click="changeContext()">Change context</button>

    <px-view-selector selected-view="{{selectedView}}"></px-view-selector>

    <px-dashboard selected-view="{{selectedView}}" context="{{context}}"></px-dashboard>

    <h1>This is the context name (not in the card): {{context.name}}</h1>
    <div>SelectedView: <span>{{selectedView}}</span></div>

</template>


