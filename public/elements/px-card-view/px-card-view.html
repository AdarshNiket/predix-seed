<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="/bower_components/px-card-view/px-card-view.html">

<dom-module id="px-card-view">
  <template>
    <!-- insert px-view element here -->
  </template>
  <script>
    Polymer({

      is: 'px-card-view',

      properties: {
        cardData: {
          type: Object,
          value: function() { return {}; }
        },
        _cardActive: {
          type: Boolean,
          value: true
        },
        _cardElementHref: {
          type: String,
          computed: '_computeCardElementHref(cardData)'
        }
      },

      _viewElement: null,

      observers: [
        '_attachView(_cardElementHref)'
      ],

      _computeCardElementHref: function() {
        if(Object.keys(this.cardData).length) {
          if(this.cardData.attributes.elementHref) {
            return this.cardData.attributes.elementHref;
          } else {
            return '/elements/cards/' + this.cardData.slug + '.html'
          }
        }
      },

      _attachView: function() {
        // remove previously attached view element
        if(this._viewElement) {
          Polymer.dom(this).removeChild(this._viewElement);
        }
        // create view element
        this._viewElement = document.createElement('px-view');
        // set view element attributes
        this._viewElement.setAttribute('id', 'px-view-' + new Date().getTime());
        this._viewElement.setAttribute('active', this._cardActive);
        this._viewElement.setAttribute('element-href', this._cardElementHref);
        // append view element to DOM
        this.appendChild(this._viewElement);
      }

    });
  </script>
</dom-module>
